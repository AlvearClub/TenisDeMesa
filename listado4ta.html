<html>
<head>
<style>
        table, th, td
        {
            margin:3vh 0;
            padding:2px 0.8vh;
            text-align: center;
            font:2vh 'Poppins';
        }
        th {
            font-weight:bold;
            font-family: Verdana, Tahoma, sans-serif;
        }
        bdi{
          font-size: 2.6vh;
          font-family: inherit;
          text-align: center;
        }
        bdo{
          margin-top: 17vh;
        }
#loader {
  border: 16px solid white;
  border-radius: 50%;
  border-top: 16px solid #052f6e;
  border-bottom: 16px solid #052f6e;
  width: 60px;
  height: 60px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
  visibility:hidden;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

    </style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script>

  var script_url = "https://script.google.com/macros/s/AKfycbxZ_KeX9t1l4r9b4WzKzbHiHSA1LBPjyeWbJafG9B0puuLD4LL6/exec";

  // print the returned data
  function ctrlq(e) {


	$("#re").html(e.result);
	$("#re").css("visibility","visible");
	read_value();

  }




function read_value() {

$("#re").css("visibility","hidden");

   document.getElementById("loader").style.visibility = "visible";
 var url = script_url+"?action=read";

$.getJSON(url, function (json) {

    // Set the variables from the results array




        // CREATE DYNAMIC TABLE.
        var table = document.createElement("table");



        var header = table.createTHead();
		var row = header.insertRow(0);
    var cell0 = row.insertCell(0);
		var cell1 = row.insertCell(1);
		var cell2 = row.insertCell(2);
    var cell3 = row.insertCell(3);
    var nro = 1;
    cell0.innerHTML = "<bdi>N°</bdi>";
		cell1.innerHTML = "<bdi>Nombre y Apellido</bdi>";
    cell2.innerHTML = "<bdi>Perfil TMT</bdi>";

      
        for (var i = 1; i < json.records.length; i++) {

          if (json.records[i-1].CATEGORIAS.includes('4ta') && nro < 25 && json.records[i-1].PUNTAJETMT > -1) {

            tr = table.insertRow(-1);
    				var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = nro;
    				tabCell = tr.insertCell(-1);
    				tabCell.innerHTML = json.records[i-1].NOMBRES;
            tabCell = tr.insertCell(-1);
            var perfil = "https://www.tenisdemesaparatodos.com/jugadores_ficha.asp?codigo=";
            var link = perfil.concat("",json.records[i-1].CODIGOTMT) ;
    				tabCell.innerHTML = "<a href= \" "+link+" \">Ver Perfil</a>";
            nro = nro + 1;
          }
          else if(json.records[i-1].CATEGORIAS.includes('4ta') && nro == 25 && json.records[i-1].PUNTAJETMT > -1){

            tr = table.insertRow(-1);
            var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdo></bdo>";
    				tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdo></bdo>";
            tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdo></bdo>";

            tr = table.insertRow(-1);
            tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdi>&nbsp</bdi>";
    				tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdi>&nbsp</bdi>";
            tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdi>&nbsp</bdi>";
            tr = table.insertRow(-1);
            tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdi>&nbsp</bdi>";
    				tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdi>LISTA DE ESPERA</bdi>";
            tabCell = tr.insertCell(-1);
            tabCell.innerHTML = "<bdi>&nbsp</bdi>";
            tr = table.insertRow(-1);
    				tabCell = tr.insertCell(-1);
            tabCell.innerHTML = nro;
    				tabCell = tr.insertCell(-1);
    				tabCell.innerHTML = json.records[i-1].NOMBRES;
            tabCell = tr.insertCell(-1);
            var perfil = "https://www.tenisdemesaparatodos.com/jugadores_ficha.asp?codigo=";
            var link = perfil.concat("",json.records[i-1].CODIGOTMT) ;
    				tabCell.innerHTML = "<a href= \" "+link+" \">Ver Perfil</a>";
            nro = nro + 1;
          }
          else if (json.records[i-1].CATEGORIAS.includes('4ta') && nro > 25 && json.records[i-1].PUNTAJETMT > -1){
            tr = table.insertRow(-1);
    				var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = nro;
    				tabCell = tr.insertCell(-1);
    				tabCell.innerHTML = json.records[i-1].NOMBRES;
            tabCell = tr.insertCell(-1);
            var perfil = "https://www.tenisdemesaparatodos.com/jugadores_ficha.asp?codigo=";
            var link = perfil.concat("",json.records[i-1].CODIGOTMT) ;
    				tabCell.innerHTML = "<a href= \" "+link+" \">Ver Perfil</a>";
            nro = nro + 1;
          }
        }


        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
        var divContainer = document.getElementById("showData");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
		document.getElementById("loader").style.visibility = "hidden";
		$("#re").css("visibility","visible");
    });
	}

  </script>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <meta charset="utf-8"/>
  <meta name="description" content="AlvearClub"/>
  <meta name="keywords" content=""/>
  <title>Listado Inscriptos</title>
  <link rel="stylesheet" href="cssAlvear.css"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital@1&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital@1&family=Roboto&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" rel="stylesheet">


</head>
<body id="cuerpo" style="color: white;">
  <div class="row justify-content-md-center" style= "margin-top:3vh;">
      <div class="col md-4 text-center">
          <img src="Logo.png" id="imagen" style="width:25vh">
      </div>
  </div>
  <div align="center">
    <h1 style="font-family: 'Poppins', sans-serif; font-size:4vh;">
      Listado de inscriptos <br> 4ta Categoría</h1>
  </div>
  <div align="center">

    <p id="re"></p>

    <input id="b1" type="button" onclick="read_value()"class="btn" style="height: 8vh; width: 40vh; font-size: 3vh; margin-bottom: 3vh; border:1px solid white; color:white;" value="Ver Listado" />
    <input id="final" type="button" onclick="read_value()"class="btn" style="height: 8vh; width: 40vh; font-size: 3vh; margin-bottom: 3vh; display:none; border:1px solid white; color:white;" value="Actualizar Listado" />
    <div id="showData" style="margin-left: 3.5vh;">
    </div>
    <div id="loader"></div>


  </div>
  <div class="text-center">
  <p style="font-size:1.5vh; margin-top:6vh; margin-bottom:3vh;padding-right:3.6vh;color: white;">© Alvear Club Tenis de Mesa 2021 | Todos los derechos reservados.</p>
  </div>


  <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){
      $("#b1").on('click', function() {
          $("#b1").hide();
          $("#final").show();
          return false;
      });

  });
  </script>
</body>
<html>